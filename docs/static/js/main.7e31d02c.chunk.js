(this.webpackJsonpffmpeg_front=this.webpackJsonpffmpeg_front||[]).push([[0],{100:function(e,t,n){e.exports=n(114)},105:function(e,t,n){},106:function(e,t,n){},114:function(e,t,n){"use strict";n.r(t);var a,r=n(0),i=n.n(r),l=n(10),c=n.n(l),o=n(164),u=n(83),m=n(163),s=n(52),d=(n(105),n(106),n(26)),p=n(168),f=n(166),g=n(42),b=n(162),v=n(161),h=n(158),E=n(167),y=n(157),x=n(144),O=n(148),j=Object(d.a)(x.a).withConfig({displayName:"Template__StyledToolbar",componentId:"vdmnv3-0"})(["display:flex;align-items:center;justify-content:space-between;"]),F=i.a.memo((function(e){var t=e.children,n=e.rightElement;return i.a.createElement(i.a.Fragment,null,i.a.createElement(f.a,{flexDirection:"column",width:"100%",display:"flex"},i.a.createElement(O.a,{position:"relative"},i.a.createElement(j,null,i.a.createElement(g.a,{variant:"h6",color:"inherit",noWrap:!0},"FFMPEG Online"),n)),t))}));function w(e){var t=e.maxSize,n=e.accept,a=e.children,r=e.onFileLoaded,l=i.a.useRef();return i.a.useEffect((function(){l.current=document.createElement("input");var e=l.current;return e.style.display="none",e.accept=n,e.type="file",e.onchange=function(n){var a=n.target.files[0];a&&(e.value="",t&&a.size>t||r(a))},document.body.appendChild(l.current),function(){return document.body.removeChild(l.current)}}),[r]),a((function(){return l.current&&l.current.click()}))}!function(e){e.VIDEO="video/*"}(a||(a={})),w.defaultProps={accept:a.VIDEO};var k=i.a.memo(w),C=n(74);function S(){var e=Object(C.a)(["\n  cursor: pointer;\n  border: 2px dashed gray;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n"]);return S=function(){return e},e}var A=Object(d.a)(f.a)(S()),L=n(149),P=n(116),z=n(150),I=n(151),_=n(152),R=n(76),M=n.n(R),W=n(75),D=n.n(W),N=Object(d.a)(L.a).withConfig({displayName:"FileMenuItem__StyledList",componentId:"cp2rev-0"})(["li{.MuiListItem-secondaryAction{padding-right:16px;transition:padding-right 0.2s;}.file_menu_item_actions{transition:opacity 0.2s;opacity:0;}:hover{.MuiListItem-secondaryAction{padding-right:80px;}.file_menu_item_actions{opacity:1;}}}"]),U={noWrap:!0,display:"block"},V=i.a.memo((function(e){var t=e.files,n=e.selectedFileNames,a=e.toggleFileSelected,r=e.downloadFile,l=e.removeFile;return i.a.createElement(N,{disablePadding:!0},t.map((function(e){return i.a.createElement(P.a,{key:e.name,button:!0,selected:n[e.name],onClick:function(){return a(e)}},i.a.createElement(z.a,{primary:e.name,primaryTypographyProps:U}),i.a.createElement(I.a,{className:"file_menu_item_actions"},i.a.createElement(_.a,{size:"small",onClick:function(){return r(e)}},i.a.createElement(D.a,null)),i.a.createElement(_.a,{size:"small",onClick:function(){return l(e)}},i.a.createElement(M.a,null))))})))})),B=i.a.memo((function(e){var t=e.files,n=e.selectedFileNames,a=e.newFileLoader,r=e.toggleFileSelected,l=e.downloadFile,c=e.removeFile;return i.a.createElement(i.a.Fragment,null,i.a.createElement(f.a,{flex:1,overflow:"scroll"},i.a.createElement(L.a,null,i.a.createElement(V,{files:t,selectedFileNames:n,toggleFileSelected:r,removeFile:c,downloadFile:l}))),a)})),T=n(172),H=n(176),G=n(170),J=n(171),q=n(169),K=n(153),Q=i.a.memo((function(e){var t=e.children,n=e.label,a=e.node,r=e.enable,l=e.disable,c=!!a;return i.a.createElement(f.a,{display:"flex",marginRight:"18px",height:"56px"},i.a.createElement(K.a,{control:i.a.createElement(q.a,{checked:c,onChange:c?l:r}),label:n}),c&&t())})),X=Object(G.a)((function(e,t,n,a){n(Object(J.a)(e,a,t))})),Y=n(15);function Z(e){return function(t){t&&t.target?e(t.target.value):e(null)}}var $=i.a.memo((function(e){var t=e.commandArguments,n=e.setArguments,a=t.output.resize;return i.a.createElement(Q,{node:a,label:"Resize",enable:function(){return X(["output","resize"],t,n,["",""])},disable:function(){return X(["output","resize"],t,n,null)}},(function(){return i.a.createElement(f.a,{width:"200px",display:"flex"},i.a.createElement(H.a,{title:"horizontal pixel size of the video",placement:"bottom-start"},i.a.createElement(T.a,{label:"Width",value:a[0],placeholder:"1920",onChange:Z(X(["output","resize",0],t,n))})),i.a.createElement(f.a,{width:"10px"}),i.a.createElement(H.a,{title:"vertical pixel size of the video",placement:"bottom-start"},i.a.createElement(T.a,{label:"Height",value:a[1],placeholder:"1080",onChange:Z(X(["output","resize",1],t,n))})))}))})),ee=i.a.memo((function(e){var t=e.commandArguments,n=e.setArguments,a=t.input.extractPartition;return i.a.createElement(Q,{node:a,label:"Extract partition",enable:function(){return X(["input","extractPartition"],t,n,["",""])},disable:function(){return X(["input","extractPartition"],t,n,null)}},(function(){return i.a.createElement(f.a,{width:"350px",display:"flex"},i.a.createElement(H.a,{title:"Start trimming video from",placement:"bottom-start"},i.a.createElement(T.a,{label:"Start",placeholder:"00:00:00",value:a[0],onChange:Z(X(["input","extractPartition",0],t,n))})),i.a.createElement(f.a,{width:"10px"}),i.a.createElement(H.a,{title:"Video trimming length",placement:"bottom-start"},i.a.createElement(T.a,{label:"Length",value:a[1],placeholder:"00:00:00",onChange:Z(X(["input","extractPartition",1],t,n))})))}))})),te=i.a.memo((function(e){var t=e.commandArguments,n=e.setArguments,a=t.input.bitrate;return i.a.createElement(Q,{node:a,label:"Bitrate",enable:function(){return X(["input","bitrate"],t,n,["",""])},disable:function(){return X(["input","bitrate"],t,n,null)}},(function(){return i.a.createElement(f.a,{width:"300px",display:"flex"},i.a.createElement(H.a,{title:"Video bitrate",placement:"bottom-start"},i.a.createElement(T.a,{label:"Video",placeholder:"4m",value:a[0],onChange:Z(X(["input","bitrate",0],t,n))})),i.a.createElement(f.a,{width:"10px"}),i.a.createElement(H.a,{title:"Audio bitrate",placement:"bottom-start"},i.a.createElement(T.a,{label:"Audio",placeholder:"128k",value:a[1],onChange:Z(X(["input","bitrate",1],t,n))})))}))})),ne=[{name:"Copy original",value:"copy"},{name:"H.264",value:"libx264"},{name:"H.265",value:"libx265",disabled:!0},{name:"MPEG-4 (part 2)",value:"mpeg4"},{name:"AV1",value:"libaom-av1",disabled:!0},{name:"VP8",value:"libvpx",disabled:!0},{name:"VP9 (google)",value:"libvpx-vp9",disabled:!0},{name:"Apple ProRes",value:"prores",supportedOutputs:["mkv"]}],ae=[{name:"Copy original",value:"copy"},{name:"Vorbis",value:"libvorbis",disabled:!0},{name:"AAC",value:"aac"},{name:"OPUS",value:"opus"}],re=i.a.memo((function(e){var t=e.commandArguments,n=e.type,a=e.label,r=e.items,l=e.setArguments,c=X(["input",n],t,l);return i.a.createElement(Q,{node:t.input[n],label:a,enable:function(){return c("copy")},disable:function(){return c(null)}},(function(){return i.a.createElement(f.a,{width:"140px",display:"flex"},i.a.createElement(y.a,{variant:"outlined",fullWidth:!0},i.a.createElement(E.a,{value:t.input[n],onChange:Z(c)},r.map((function(e){var t=e.name,n=e.value,a=e.disabled;return i.a.createElement(h.a,{key:n,disabled:a,value:n},t)})))))}))})),ie=function(e){return i.a.createElement(re,Object.assign({},e,{label:"Video Codec",type:"videoCodec",items:ne}))},le=function(e){return i.a.createElement(re,Object.assign({},e,{label:"Audio Codec",type:"audioCodec",items:ae}))},ce=i.a.memo((function(e){return i.a.createElement(f.a,{display:"flex",flexWrap:"wrap"},i.a.createElement($,e),i.a.createElement(ee,e),i.a.createElement(te,e),i.a.createElement(ie,e),i.a.createElement(le,e))})),oe=n(59),ue=n.n(oe),me=n(79),se=n(11),de=n(174),pe=n(175),fe=n(159),ge=n(160),be=n(51),ve=n(30),he=n(80),Ee=n(81),ye=n(86),xe=function(e){function t(e){var n;return Object(be.a)(this,t),(n=Object(he.a)(this,Object(Ee.a)(t).call(this))).reader=void 0,n.worker=void 0,n.reader=new FileReader,n.worker=new Worker(URL.createObjectURL(new Blob(["\n".concat(e,"\n").concat(document.getElementById("ffmpeg-worker").innerHTML,"\nffmpegForker();\n")]))),n.init(),n}return Object(ye.a)(t,e),Object(ve.a)(t,[{key:"init",value:function(){var e=this;this.worker.postMessage("".concat(document.location.href,"static/js/"));this.worker.addEventListener("message",(function(t){var n=t.data,a=n.type,r=n.data;switch(a){case"synchronizeFileSystem":e.emit("synchronizeFileSystem",r);break;case"log":e.emit("log",r)}}))}},{key:"run",value:function(e){this.worker.postMessage({type:"run",data:e})}},{key:"loadFile",value:function(e,t){var n=this,a=new Blob([t],{type:t.type});return new Promise((function(t){n.reader.onload=function(a){n.worker.postMessage({type:"loadFile",data:{name:e,array:a.target.result}}),t()},n.reader.readAsArrayBuffer(a)}))}},{key:"runWatcher",value:function(e){var t=this,n=function(t){var n=t.data,a=n.type,r=n.data;"fileWatcherTick"===a&&e(r)};return this.worker.addEventListener("message",n),function(){return t.worker.removeEventListener("message",n)}}},{key:"removeFile",value:function(e){this.worker.postMessage({type:"removeFile",data:e})}},{key:"synchronizeFileSystem",value:function(e){this.worker.postMessage({type:"synchronizeFileSystem",data:e})}}]),t}(n(82).EventEmitter),Oe=n(17),je=n(77),Fe={bitrate:function(e){var t=Object(Y.a)(e,2),n=t[0],a=t[1];return[].concat(Object(Oe.a)(n?["-b:v",n]:[]),Object(Oe.a)(a?["-b:a",a]:[]))},resize:function(e){var t=Object(Y.a)(e,2),n=t[0],a=t[1];return["-vf","scale=".concat(n,":").concat(a)]},extractPartition:function(e){var t=Object(Y.a)(e,2);return["-ss",t[0],"-t",t[1]]},videoCodec:function(e){return["-c:v",e]},audioCodec:function(e){return["-c:a",e]}};function we(e,t,n){t[e]&&n.push.apply(n,Object(Oe.a)(Fe[e](t[e])))}function ke(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=["ffmpeg","-threads","1","-y","-loglevel","debug","-nostdin"];return e.inputs.forEach((function(e){a.push("-i","".concat(t).concat(e))})),a.push("-strict","-2"),Object.keys(e.arguments.input).forEach((function(t){we(t,e.arguments.input,a)})),a.push("".concat(t,"output").concat(n,".").concat(e.outputFileExtension)),Object.keys(e.arguments.output).forEach((function(t){we(t,e.arguments.output,a)})),a}function Ce(){var e=i.a.useState((function(){return{inputs:[],outputFileExtension:"mp4",arguments:{input:{audioCodec:"copy",videoCodec:"copy"},output:{}}}})),t=Object(Y.a)(e,2),n=t[0],a=t[1];return{command:n,setInputs:function(e){return a(Object(je.a)("inputs",e,n))},setOutputExtension:function(e){return a(Object(je.a)("outputFileExtension",e,n))},getString:function(){return function(e){return ke(e).join(" ")}(n)},getArray:function(e,t){return ke(n,e,t)},setArguments:function(e){return a(Object(je.a)("arguments",e,n))}}}function Se(e,t){var n=i.a.useState((function(){return fetch("".concat("/ffmpeg_js_ui","/static/js/ffmpeg-core.js")).then((function(e){return e.text()}))})),a=Object(Y.a)(n,1)[0],r=Ce(),l=i.a.useState(null),c=Object(Y.a)(l,2),o=c[0],u=c[1],m=i.a.useRef("");return i.a.useEffect((function(){return a.then((function(n){setInterval((function(){e(m.current),m.current=""}),1e3);var a=new xe(n);a.on("log",(function(e){m.current+="".concat(e,"\n\n")})),a.on("synchronizeFileSystem",t),u(a)})),function(){return clearInterval(void 0)}}),[]),{ffmpegLoaded:!!o,commandApi:r,removeFile:function(e){return o.removeFile(e)},run:function(e){return o.run(r.getArray("/src/",(t=r.command,e.find((function(e){return e.name==="output.".concat(t.outputFileExtension)}))?".".concat(Date.now().toString()):"")));var t},loadFile:function(e){return o.loadFile(e.name,e.file)},runFilesWatcher:function(e){return o.runWatcher(e)},synchronizeFileSystem:function(e){return o.synchronizeFileSystem(e)}}}function Ae(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}var Le=function(e){var t=function(){var e=Object(r.useState)(),t=Object(Y.a)(e,2)[1];return function(){return t({})}}(),n=i.a.useRef([]),a=i.a.useState({}),l=Object(Y.a)(a,2),c=l[0],o=l[1],u=Se((function(t){t&&(e.current?e.current.innerHTML+=t:console.log(t))}),(function(e){e.forEach((function(e){var t=e.fileName,a=e.url,r=n.current.find(Object(p.a)("name",t));r&&(r.objectURL=a)})),t()})),m=u.ffmpegLoaded,s=u.commandApi,d=u.run,f=u.loadFile,g=u.runFilesWatcher,b=u.removeFile,v=u.synchronizeFileSystem;i.a.useEffect((function(){m&&g((function(e){var a=!1;Object.keys(e).forEach((function(e){n.current.find(Object(p.a)("name",e))||(n.current=Object(de.a)({name:e,file:null,objectURL:null},n.current),a=!0)})),a&&v(n.current.map(Object(pe.a)("name"))),t()}))}),[m]);var h=i.a.useState(!1),E=Object(Y.a)(h,2),y=E[0],x=E[1];function O(){return(O=Object(me.a)(ue.a.mark((function e(a){return ue.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.current=Object(de.a)({name:a.name,file:a},n.current),e.next=3,Promise.all(n.current.map(f));case 3:t();case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return i.a.useEffect((function(){var e=Object.keys(c);s.setInputs(e),x(!!e.length)}),[c]),{ffmpegLoaded:m,selectedFiles:c,commandApi:s,selectedFilesNotEmpty:y,localFiles:n.current,run:function(){return d(n.current)},toggleSelectFile:function(e){c[e.name]?o(Object(fe.a)([e.name],c)):o(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ae(n,!0).forEach((function(t){Object(se.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ae(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},c,Object(se.a)({},e.name,!0)))},uploadFile:function(e){return O.apply(this,arguments)},downloadFile:function(e){var t=document.createElement("a");t.download=e.name,document.body.appendChild(t),e.objectURL?t.href=e.objectURL:t.href=URL.createObjectURL(new Blob([e.file])),t.click(),document.body.removeChild(t)},removeFile:function(e){b(e.name),n.current=Object(ge.a)(n.current.findIndex(Object(p.a)("name",e.name)),1,n.current),o(Object(fe.a)([e.name],c))}}},Pe=d.a.code.withConfig({displayName:"Main__StyledCode",componentId:"sek1mb-0"})(["white-space:pre-wrap;overflow:scroll;background-color:white;padding:12px;flex:1;"]),ze=["mp4","avi","mpg","mkv"],Ie=i.a.memo((function(){var e=i.a.useRef(null),t=Le(e),n=t.ffmpegLoaded,a=t.selectedFiles,r=t.commandApi,l=t.selectedFilesNotEmpty,c=t.localFiles,o=t.toggleSelectFile,u=t.uploadFile,m=t.downloadFile,s=t.removeFile,d=t.run,x=r.command.arguments.input.videoCodec,O=i.a.useMemo((function(){return ne.find(Object(p.a)("value",x))}),[x]);return i.a.useEffect((function(){O&&O.supportedOutputs&&r.setOutputExtension(O.supportedOutputs[0])}),[O]),i.a.createElement(F,{rightElement:i.a.createElement(f.a,{display:"flex",alignItems:"center"},l&&i.a.createElement(v.a,{variant:"contained",color:"default",size:"large",onClick:d},"run"))},0===c.length?i.a.createElement(f.a,{display:"flex",flex:1,justifyContent:"center",alignItems:"center"},n?i.a.createElement(k,{onFileLoaded:u},(function(e){return i.a.createElement(A,{padding:"100px 180px",onClick:e},i.a.createElement(g.a,null,"Click here to select file"))})):i.a.createElement(i.a.Fragment,null,i.a.createElement(b.a,null),i.a.createElement(g.a,null,"Loading FFMPEG library..."))):i.a.createElement(f.a,{display:"flex",flex:1,height:"calc(100vh - 64px)"},i.a.createElement(f.a,{height:"100%",width:"20%",padding:"18px",borderRight:"1px solid lightgray",display:"flex",flexDirection:"column"},i.a.createElement(B,{files:c,selectedFileNames:a,newFileLoader:i.a.createElement(k,{onFileLoaded:u},(function(e){return i.a.createElement(A,{padding:"10px 100px",onClick:e},i.a.createElement(g.a,null,"Upload file"))})),downloadFile:m,removeFile:s,toggleFileSelected:o})),i.a.createElement(f.a,{height:"100%",width:"80%",padding:"18px",display:"flex",flexDirection:"column",justifyContent:"space-between"},i.a.createElement(f.a,{padding:"18px",display:"flex"},i.a.createElement(f.a,{bgcolor:"lightgray",marginRight:"18px",flex:1,display:"flex",alignItems:"center",padding:"0 18px"},i.a.createElement("code",null,r.getString())),i.a.createElement(f.a,{width:"100px",marginBottom:"2px"},i.a.createElement(y.a,{variant:"outlined",fullWidth:!0},i.a.createElement(E.a,{value:r.command.outputFileExtension,onChange:Z(r.setOutputExtension)},(O&&O.supportedOutputs||ze).map((function(e){return i.a.createElement(h.a,{key:e,value:e},e)})))))),i.a.createElement(f.a,{padding:"18px"},i.a.createElement(ce,{commandArguments:r.command.arguments,setArguments:r.setArguments})),i.a.createElement(f.a,{flexDirection:"column",display:"flex",height:"100%"},i.a.createElement(f.a,{padding:"18px",display:"flex",alignItems:"center",justifyContent:"flex-end"},i.a.createElement(v.a,{onClick:function(){return e.current.innerHTML=""}},"Clear logs")),i.a.createElement(Pe,{ref:e})))))})),_e=Object(u.a)({palette:{secondary:{main:m.a[900]},primary:{main:s.a[700]}}}),Re=function(){return i.a.createElement(o.a,{theme:_e},i.a.createElement(Ie,null))};c.a.render(i.a.createElement(Re,null),document.getElementById("root"))}},[[100,1,2]]]);
//# sourceMappingURL=main.7e31d02c.chunk.js.map